summary: Integration tests for golang-1.22-go

execute: |
  rootfs="$(install-slices golang-1.22-go_bins golang-1.22-src_all)"

  mkdir "${rootfs}/proc"
  mount --bind /proc "${rootfs}/proc"

  mkdir "${rootfs}/dev"
  touch "${rootfs}/dev/null"

  mkdir "${rootfs}/tmp"

  mkdir "${rootfs}/app"
  cp main.go "${rootfs}/app/"

  chroot "${rootfs}/" /usr/lib/go-1.22/bin/go version
  chroot "${rootfs}/" /usr/lib/go-1.22/bin/go run /app/main.go | grep "hello world"

  chroot "${rootfs}/" /usr/lib/go-1.22/bin/gofmt /app/main.go > /dev/null


  umount "${rootfs}/proc"
  rm -rf "${rootfs}/proc"
  rm -rf "${rootfs}/dev"
