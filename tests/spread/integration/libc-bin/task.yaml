summary: Integration tests for libc-bin

environment:
  SLICE/getconf: "getconf"
  SLICE/ldconfig: "ldconfig"
  SLICE/locale: "locale"

execute: |
  rootfs="$(install-slices libc-bin_${SLICE})"

  case SLICE in
    getconf)
      chroot "$rootfs" getconf -a
    ;;
    ldconfig)
      chroot "$rootfs" ldconfig
      chroot "$rootfs" ldconfig -p | grep libc.so.6
    ;;
    locale)
      chroot "$rootfs" locale | grep 'LC_CTYPE="en_US.UTF-8"'
      chroot "$rootfs" locale -a | grep -i 'C.utf8'
    ;;
  esac
