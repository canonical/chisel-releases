summary: Integration tests for ca-certificates-java

environment:
  SLICE/bins: "bins"

execute: |
  # Test bins slice installation
  echo "SLICE=${SLICE}"
  rootfs="$(install-slices ca-certificates-java_${SLICE} openjdk-8-jre-headless_security)"

  cd ${rootfs}
  chroot . /bin/bash /usr/sbin/update-ca-certificates
  chroot . find /etc/ssl/certs/ -name *.pem -exec echo +{} \; > ${rootfs}/certs
  mkdir -p proc/self
  for java in $(find /usr/lib/jvm -name java -type f); do
    ln -s /${java} proc/self/exe
    chroot . /${java} -jar /usr/share/ca-certificates-java/ca-certificates-java.jar < certs
  done
