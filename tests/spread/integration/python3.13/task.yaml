summary: Integration tests for python3.13

environment:
  SLICE/core: "core"
  SLICE/standard: "standard"

execute: |
  # Test different slice installations
  echo "SLICE=${SLICE}"

  rootfs="$(install-slices python3.13_${SLICE})"

  cp test_${SLICE}.py "${rootfs}/"
  chroot "$rootfs" python3.13 /test_${SLICE}.py

  if [ "$SLICE" == "standard" ]; then
    # Test that _pyrepl module is available in the standard slice
    # This is tricky to test since python will not import _pyrepl in
    # non-interactive mode by default. Hence we just test for the import
    # failure directly.
    # https://github.com/canonical/python-rock/issues/36
    chroot "$rootfs" python3.13 -c "import _pyrepl;"
  fi
