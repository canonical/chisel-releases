summary: Integration tests for Ruby

environment:
  SLICE/core: "core"
  SLICE/ruby: "ruby"

execute: |
  rootfs="$(install-slices ruby_${SLICE})"
  
  mkdir "${rootfs}/run"
  mount --bind /run "${rootfs}/run"
  
  mkdir "${rootfs}/etc"
  echo 'nameserver 8.8.8.8' | tee "${rootfs}/etc/resolv.conf"

  cp ../ruby3.3/ruby_smoke_test.rb "${rootfs}/"
  chroot "$rootfs" ruby /ruby_smoke_test.rb
