package: rabbitmq-server

essential:
  - rabbitmq-server_copyright

# NOTE: erlang* packages do not exist for i386.
# The following commented slices should be manually included when cutting the
# slices for rabbitmq-server.
slices:
  autocomplete:
    contents:
      /usr/lib/rabbitmq/autocomplete/*:

  bins:
    essential:
      - base-files_bin
      - base-files_etc
      - base-files_home
      - base-files_var
      - base-passwd_data
      - bash_bins
      - coreutils_bins
      - grep_bins
      - libc-bin_locale
      - libc-bin_nsswitch
      - libtinfo6_libs
      - login_bins
      - netbase_default-hosts
      - netbase_default-networks
      - passwd_bins
      - python3.13_standard
      - rabbitmq-server_config
      - rabbitmq-server_modules
      - sed_bins
      - util-linux_su-support
    v3-essential:
      erlang-base_bins: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-inets_scripts: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-inets_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-os-mon_bins: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
    contents:
      /usr/bin/rabbitmqadmin:
      /usr/lib/ocf/resource.d/rabbitmq/rabbitmq-server:
      /usr/lib/rabbitmq/bin/rabbitmq*:
      /usr/lib/rabbitmq/bin/vmware-rabbitmq:
      /usr/lib/rabbitmq/lib/rabbitmq_server-*/escript/rabbitmq-diagnostics:
      /usr/lib/rabbitmq/lib/rabbitmq_server-*/sbin/rabbitmq*:
      /usr/lib/rabbitmq/lib/rabbitmq_server-*/sbin/vmware-rabbitmq:
      # TODO: the files below are hardlinks
      # To be fixed when hardlinks are supported
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-plugins:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-queues:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-streams:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-upgrade:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmqctl:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/vmware-rabbitmq:
        copy: /usr/lib/rabbitmq/lib/rabbitmq_server-4.0.5/escript/rabbitmq-diagnostics
      /usr/sbin/rabbitmq*:
      /var/lib/rabbitmq/:
      # The following is a cookie file necessary for rabbitmq-server to work
      # The contents of that cookie file should be generated by the command:
      # openssl rand -base64 -out /var/lib/rabbitmq/.erlang.cookie 42
      /var/lib/rabbitmq/.erlang.cookie: { text: DUMMY, mode: 0400 }
      /var/lib/rabbitmq/mnesia/: { mode: 0750 }
      /var/log/rabbitmq/:

  config:
    contents:
      /etc/default/rabbitmq-server:
      /etc/rabbitmq/rabbitmq-env.conf:
        copy: /usr/share/rabbitmq/rabbitmq-env.conf
        mode: 0644

  modules:
    v3-essential:
      erlang-crypto_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-eldap_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-mnesia_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-parsetools_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-public-key_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-runtime-tools_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-ssl_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-syntax-tools_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-tools_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
      erlang-xmerl_modules: {arch: [amd64, arm64, armhf, ppc64el, riscv64, s390x]}
    contents:
      /usr/lib/rabbitmq/lib/rabbitmq_server-*/plugins/**:

  copyright:
    contents:
      /usr/share/doc/rabbitmq-server/copyright:
