package: dpkg

essential:
  - dpkg_copyright

slices:
  bins:
    essential:
      - dpkg_config
      - dpkg_dpkg
      - dpkg_dpkg-divert
      - dpkg_dpkg-trigger
      - dpkg_scripts
      - dpkg_tables
      - dpkg_update-alternatives
      - dpkg_var
      - libbz2-1.0_libs
      - libc6_libs
      - liblzma5_libs
      - libmd0_libs
      - libselinux1_libs
      - libzstd1_libs
      - zlib1g_libs
    contents:
      /usr/bin/dpkg-maintscript-helper:
      /usr/bin/dpkg-query:
      /usr/bin/dpkg-realpath:
      /usr/bin/dpkg-statoverride:
      /usr/libexec/dpkg/*:

  config:
    contents:
      /etc/dpkg/dpkg.cfg:
      /etc/dpkg/dpkg.cfg.d/:

  locales:
    essential:
      - dpkg_bins
    contents:
      /usr/share/locale/**/dpkg.mo:

  scripts:
    essential:
      - coreutils_echo
    contents:
      # Note: This file defines the color scheme used by dpkg.
      # It is sourced by dpkg's `dpkg-maintscript-helper` script.
      /usr/share/dpkg/sh/dpkg-error.sh:

  tables:
    contents:
      /usr/share/dpkg/*table:

  var:
    # /var/log is required for dpkg to write logs to
    essential:
      - base-files_var
    # Directories that are included in the tarball because they need to exist in /var
    contents:
      /var/lib/dpkg/alternatives/:
      /var/lib/dpkg/info/:
      /var/lib/dpkg/parts/:
      /var/lib/dpkg/updates/:

  maintscript-support:
    essential:
      - base-files_bin
      - coreutils_bins
      - dpkg_bins
      - sed_bins

  dpkg-deb:
    essential:
      - base-files_tmp
      - coreutils_rm-utility
      - libbz2-1.0_libs
      - liblzma5_libs
      - libmd0_libs
      - libzstd1_libs
      - tar_tar
      - zlib1g_libs
    contents:
      /usr/bin/dpkg-deb:

  dpkg-split:
    essential:
      - dpkg_dpkg-deb
      - libc6_libs
      - libmd0_libs
    contents:
      /usr/bin/dpkg-split:

  dpkg:
    essential:
      - base-files_bin
      - coreutils_rm-utility
      - dash_bins
      - diffutils_bins
      - dpkg_dpkg-deb
      - dpkg_dpkg-split
      - dpkg_start-stop-daemon
      - libc-bin_ldconfig
      - libc6_libs
      - libmd0_libs
      - libselinux1_libs
      - tar_tar
    contents:
      /usr/bin/dpkg:

  start-stop-daemon:
    essential:
      - base-files_var  # for /var/run
      - libc6_libs
    contents:
      /usr/sbin/start-stop-daemon:

  dpkg-trigger:
    essential:
      - libc6_libs
    contents:
      /usr/bin/dpkg-trigger:
      /var/lib/dpkg/triggers/:
        make: true

  dpkg-divert:
    essential:
      - libmd0_libs
    contents:
      /usr/bin/dpkg-divert:
      /var/lib/dpkg/:
        make: true

  update-alternatives:
    essential:
      - libc6_libs
    contents:
      /usr/bin/update-alternatives:

  copyright:
    contents:
      /usr/share/doc/dpkg/copyright:
